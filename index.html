<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>„É¥„Ç°„É≥„Éë„Ç§„Ç¢ÂÖ®Áü•ÂÖ®ËÉΩ ËæûÂÖ∏</title>

<style>
:root{
  --bg:#0b0f14;
  --panel:#151822;
  --border:#252a36;
  --text:#e6e8ee;
  --muted:#9aa0aa;
  --muted2:#7b8192;

  --accent:#7b5cff;
  --accent2:#36d1dc;
  --accent3:#fb7185;
  --good:#34d399;
  --warn:#f59e0b;

  --radius:16px;
  --shadow: 0 18px 65px rgba(0,0,0,.45);
}

*{box-sizing:border-box}

body{
  background:
    radial-gradient(1200px 700px at 10% 10%, rgba(123,92,255,.22), transparent 55%),
    radial-gradient(900px 600px at 90% 15%, rgba(54,209,220,.16), transparent 55%),
    radial-gradient(900px 650px at 20% 90%, rgba(251,113,133,.12), transparent 55%),
    var(--bg);
  color:var(--text);
  font-family:"Yu Gothic","Hiragino Kaku Gothic ProN",system-ui,sans-serif;
  margin:0;
  line-height:1.95;
}

header{
  position:sticky;
  top:0;
  z-index:10;
  background: rgba(11,15,20,.72);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-bottom:1px solid var(--border);
}

.topbar{
  max-width:1150px;
  margin:auto;
  padding:18px 18px 12px;
  display:flex;
  gap:18px;
  align-items:flex-start;
  justify-content:space-between;
  flex-wrap:wrap;
}

.brand{min-width:280px;}
.brand .t{
  font-size:20px;
  font-weight:800;
  letter-spacing:1.4px;
}
.brand .s{
  margin-top:6px;
  color:var(--muted);
  font-size:13px;
}
.brand .s span{color:var(--muted2);}

nav{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:flex-end;
}

.tabbtn{
  cursor:pointer;
  border:1px solid var(--border);
  background: rgba(255,255,255,.05);
  color:var(--muted);
  padding:9px 12px;
  border-radius:999px;
  font-size:13px;
  user-select:none;
  transition: transform .08s ease, background .2s ease, color .2s ease, border-color .2s ease;
  box-shadow: var(--shadow);
}
.tabbtn:active{ transform: translateY(1px); }
.tabbtn.active{
  color:var(--text);
  border-color: rgba(54,209,220,.35);
  background: linear-gradient(90deg, rgba(123,92,255,.18), rgba(54,209,220,.15), rgba(251,113,133,.12));
}

.container{
  max-width:1150px;
  margin:auto;
  padding:34px 18px 90px;
}

.section{ display:none; }
.section.active{ display:block; }

.grid{
  display:grid;
  grid-template-columns: 1.15fr .85fr;
  gap:16px;
}
@media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

.panel{
  background: rgba(255,255,255,.06);
  border:1px solid var(--border);
  border-radius:22px;
  padding:16px;
  box-shadow: var(--shadow);
}

.panel h2{
  margin: 0 0 8px;
  font-size: 15px;
  letter-spacing:.6px;
}

.hint{
  color:var(--muted);
  font-size:13px;
  margin-top:0;
}

.row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}

.searchbox{
  margin-top:12px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.searchbox input{
  flex: 1 1 320px;
  padding:12px 14px;
  border-radius:14px;
  border:1px solid var(--border);
  background: rgba(255,255,255,.06);
  color:var(--text);
  outline:none;
}
.searchbox input::placeholder{ color:var(--muted2); }

.toggle{
  display:flex;
  align-items:center;
  gap:8px;
  color:var(--muted);
  font-size:12px;
  user-select:none;
}
.toggle input{ transform: translateY(1px); }

.btn{
  cursor:pointer;
  border:1px solid var(--border);
  background: rgba(255,255,255,.05);
  color:var(--text);
  padding:8px 10px;
  border-radius:12px;
  font-size:12px;
  user-select:none;
}
.btn.primary{
  border-color: rgba(54,209,220,.35);
  background: rgba(54,209,220,.12);
}
.btn.danger{
  border-color: rgba(251,113,133,.35);
  background: rgba(251,113,133,.10);
}
.btn.good{
  border-color: rgba(52,211,153,.35);
  background: rgba(52,211,153,.10);
}
.btn.warn{
  border-color: rgba(245,158,11,.35);
  background: rgba(245,158,11,.10);
}

.card{
  background: rgba(255,255,255,.07);
  border:1px solid var(--border);
  border-radius: var(--radius);
  padding:16px;
  margin-top:12px;
}
.card.exact{
  border-color: rgba(54,209,220,.38);
  box-shadow: 0 0 0 1px rgba(54,209,220,.08), var(--shadow);
}

.jp{
  font-size:22px;
  font-weight:900;
  letter-spacing:.5px;
  color:var(--accent2);
}
.hira{
  margin-top:6px;
  color:var(--muted);
  font-size:13px;
}
.mean{
  margin-top:8px;
  font-size:14px;
  color:var(--text);
  font-weight:600;
}

.badges{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:10px;
}
.badge{
  font-size:11px;
  border:1px solid var(--border);
  padding:3px 8px;
  border-radius:999px;
  color:var(--muted);
}
.badge.n5{ border-color: rgba(52,211,153,.35); color: rgba(52,211,153,.95); }
.badge.n4{ border-color: rgba(123,92,255,.45); color: rgba(123,92,255,.95); }
.badge.tag{ border-color: rgba(54,209,220,.35); color: rgba(54,209,220,.95); }
.badge.exact{ border-color: rgba(54,209,220,.55); color: rgba(54,209,220,.95); }

.ex{
  margin-top:14px;
  padding-top:12px;
  border-top:1px solid rgba(255,255,255,.08);
}
.ex h4{
  margin:0 0 6px;
  font-size:13px;
  color:var(--accent2);
}
.exline{ margin:10px 0 10px; }
.exline b{ color:var(--text); }
.exline .k{ color:var(--accent2); }
.exp{
  color:var(--muted);
  font-size:13px;
  margin-top:6px;
}

.kanjigrid{
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(92px, 1fr));
  gap:12px;
  margin-top:12px;
}
.kanjiitem{
  background: rgba(255,255,255,.06);
  border:1px solid var(--border);
  border-radius: 16px;
  padding:12px 10px;
  text-align:center;
  cursor:pointer;
  transition: transform .12s ease, border-color .2s ease;
}
.kanjiitem:hover{
  transform: translateY(-1px);
  border-color: rgba(54,209,220,.28);
}
.kanjiitem .k{
  font-size:28px;
  font-weight:900;
  color:var(--accent2);
}
.kanjiitem .lvl{
  margin-top:6px;
  font-size:11px;
  color:var(--muted);
}
.kanjiitem .lvl b{ color:var(--text); }

.strokeBox{
  margin-top:12px;
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;
  overflow:hidden;
  background: rgba(255,255,255,.04);
}
.strokeHead{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:10px 12px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.strokeHead .t{ font-size:13px; color: var(--muted); }
.strokeBody{
  padding:12px;
}
.strokeBody svg{
  width:100%;
  height:auto;
  display:block;
}
.strokeNote{
  color: var(--muted);
  font-size:12px;
  margin-top:8px;
}

.bigKanji{
  font-size:86px;
  font-weight:900;
  letter-spacing:2px;
  text-align:center;
  color: var(--accent2);
  line-height:1.0;
  margin: 8px 0 6px;
}
.quizInputs{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
@media (max-width: 720px){ .quizInputs{ grid-template-columns: 1fr; } }

hr.sep{
  border:none;
  border-top:1px solid rgba(255,255,255,.08);
  margin:14px 0;
}
.small{
  color:var(--muted);
  font-size:13px;
}
.small b{ color:var(--text); }

.footer{
  text-align:center;
  padding:40px 0 0;
  color:var(--muted);
  font-size:12px;
}
</style>
</head>

<body>

<header>
  <div class="topbar">
    <div class="brand">
      <div class="t">„É¥„Ç°„É≥„Éë„Ç§„Ç¢ÂÖ®Áü•ÂÖ®ËÉΩ ËæûÂÖ∏</div>
      <div class="s">
        „É¥„Ç°„É≥„Éë„Ç§„Ç¢ = vampiro <span>Ôºàobservador eternoÔºâ</span> / ÂÖ®Áü• = onisciente / ÂÖ®ËÉΩ = onipotente
      </div>
    </div>

    <nav>
      <div class="tabbtn active" id="tab-dic">üìñ Dicion√°rio</div>
      <div class="tabbtn" id="tab-kanji">üà∂ Kanji (N5‚ÜíN4)</div>
      <div class="tabbtn" id="tab-quiz">üéÆ Jogo</div>
      <div class="tabbtn" id="tab-about">‚ÑπÔ∏è Sobre</div>
    </nav>
  </div>
</header>

<div class="container">

  <!-- ====================== DICION√ÅRIO ====================== -->
  <section id="dic" class="section active">
    <div class="grid">
      <div class="panel">
        <div class="row">
          <div>
            <h2>Dicion√°rio (JP ‚Üí PT-BR)</h2>
            <p class="hint">Busca ranqueada (exato primeiro). Aceita kanji/kana/portugu√™s.</p>
          </div>

          <label class="toggle" title="Se existir uma entrada exata, mostra s√≥ ela.">
            <input type="checkbox" id="onlyExact" />
            s√≥ exato (quando houver)
          </label>
        </div>

        <div class="searchbox">
          <input id="q" type="text" placeholder="Buscar palavra..." autocomplete="off" />
          <div class="btn danger" id="btnClear">Limpar</div>
        </div>

        <div id="results"></div>
      </div>

      <div class="panel">
        <h2>Uso / M√©todo</h2>
        <p class="small">
          1) Busque a palavra ‚Üí confirme leitura e significado.<br>
          2) Leia as 3 frases (JP ‚Üí hiragana ‚Üí PT).<br>
          3) Entenda as estruturas na explica√ß√£o.<br>
          4) Fa√ßa varia√ß√µes mantendo o padr√£o.<br>
        </p>

        <hr class="sep" />

        <div class="row">
          <div class="btn primary" id="btnRandom">Palavra aleat√≥ria</div>
          <div class="btn" id="btnGoKanji">Ver kanji (N5‚ÜíN4)</div>
          <div class="btn warn" id="btnGoQuiz">Ir pro jogo</div>
        </div>

        <hr class="sep" />

        <p class="small">
          <b>Meta 2000:</b> este arquivo suporta 2000+ itens (renderiza s√≥ top resultados).
          Voc√™ s√≥ precisa adicionar entradas no array <b>WORDS</b>.
        </p>
      </div>
    </div>
  </section>

  <!-- ====================== KANJI LISTA ====================== -->
  <section id="kanji" class="section">
    <div class="grid">
      <div class="panel">
        <h2>Kanji ‚Äî ordem N5 ‚Üí N4</h2>
        <p class="hint">Clique num kanji: mostra leitura/significado + ordem dos tra√ßos.</p>
        <div class="kanjigrid" id="kanjigrid"></div>
      </div>

      <div class="panel">
        <h2>Detalhe do Kanji</h2>
        <p class="hint">Selecione um kanji na lista.</p>

        <div id="kanjiDetail" class="card" style="display:none;">
          <div class="jp" id="kdKanji"></div>
          <div class="hira" id="kdReadings"></div>
          <div class="mean" id="kdMean"></div>
          <div class="badges" id="kdBadges"></div>

          <div class="strokeBox">
            <div class="strokeHead">
              <div class="t">Ordem dos tra√ßos (Stroke order)</div>
              <div class="btn" id="kdReloadStroke">Recarregar</div>
            </div>
            <div class="strokeBody" id="kdStroke"></div>
            <div class="strokeNote">Se n√£o aparecer: GitHub Pages precisa carregar o SVG online (KanjiVG).</div>
          </div>

          <hr class="sep">
          <div class="row">
            <div class="btn primary" id="kdSearchDic">Buscar no Dicion√°rio</div>
            <div class="btn warn" id="kdGoQuiz">Treinar no Jogo</div>
          </div>
        </div>

        <div id="kanjiDetailEmpty" class="card">
          <div class="mean" style="color:var(--muted);">Clique em um kanji para ver detalhes aqui.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- ====================== QUIZ (JOGO) ====================== -->
  <section id="quiz" class="section">
    <div class="grid">
      <div class="panel">
        <div class="row">
          <div>
            <h2>Jogo ‚Äî leitura e significado</h2>
            <p class="hint">Pense e/ou digite ‚Üí clique em <b>Verificar</b>. O sistema mostra se acertou e revela a resposta.</p>
          </div>
          <label class="toggle" title="Se ligado, o jogo pega s√≥ N5; se desligado, pega N5+N4 quando voc√™ expandir.">
            <input type="checkbox" id="quizOnlyN5" checked />
            somente N5
          </label>
        </div>

        <div class="card">
          <div class="bigKanji" id="quizKanji">‰∏Ä</div>
          <div class="quizInputs">
            <div>
              <div class="hira">Leitura (hiragana/katakana)</div>
              <div class="searchbox" style="margin-top:6px;">
                <input id="quizReading" placeholder="ex: „ÅÑ„Å° / „Å™„Å™ / „Å≤„Å®" />
              </div>
            </div>
            <div>
              <div class="hira">Significado (PT-BR)</div>
              <div class="searchbox" style="margin-top:6px;">
                <input id="quizMeaning" placeholder="ex: um / sete / pessoa" />
              </div>
            </div>
          </div>

          <div class="row" style="margin-top:12px;">
            <div class="btn primary" id="quizCheck">Verificar</div>
            <div class="btn" id="quizReveal">Revelar (sem pontuar)</div>
            <div class="btn warn" id="quizNext">Pr√≥ximo</div>
            <div class="btn danger" id="quizReset">Zerar</div>
          </div>

          <div class="badges" style="margin-top:12px;">
            <span class="badge" id="quizScore">Acertos: 0 ¬∑ Erros: 0 ¬∑ Streak: 0</span>
            <span class="badge tag" id="quizMode">Modo: N5</span>
          </div>

          <div id="quizFeedback" class="card" style="display:none;margin-top:12px;">
            <div class="mean" id="quizFeedbackTitle"></div>
            <div class="hira" id="quizFeedbackDetail"></div>

            <div class="strokeBox" style="margin-top:12px;">
              <div class="strokeHead">
                <div class="t">Ordem dos tra√ßos (Stroke order)</div>
                <div class="btn" id="quizReloadStroke">Recarregar</div>
              </div>
              <div class="strokeBody" id="quizStroke"></div>
              <div class="strokeNote">Se n√£o aparecer: √© carregado online (KanjiVG).</div>
            </div>
          </div>
        </div>
      </div>

      <div class="panel">
        <h2>Como ‚Äúacerto‚Äù √© calculado</h2>
        <p class="small">
          ‚Ä¢ Leitura: aceita qualquer leitura v√°lida cadastrada (ex.: „ÅÑ„Å° / „Å≤„Å®).<br>
          ‚Ä¢ Significado: voc√™ pode digitar um termo chave (ex.: ‚Äúum‚Äù, ‚Äúpessoa‚Äù, ‚Äúchuva‚Äù).<br>
          ‚Ä¢ Dica: o jogo √© treino ‚Äî o importante √© repeti√ß√£o + corre√ß√£o r√°pida.
        </p>
        <hr class="sep">
        <p class="small">
          <b>Quer ficar mais dif√≠cil?</b><br>
          Eu consigo trocar para m√∫ltipla escolha (4 alternativas) e adicionar ‚Äútimer‚Äù.
        </p>
      </div>
    </div>
  </section>

  <!-- ====================== SOBRE ====================== -->
  <section id="about" class="section">
    <div class="panel">
      <h2>Sobre ‚Äî „É¥„Ç°„É≥„Éë„Ç§„Ç¢ÂÖ®Áü•ÂÖ®ËÉΩ</h2>
      <p class="small">
        Este dicion√°rio + jogo fazem parte do projeto <b>„É¥„Ç°„É≥„Éë„Ç§„Ç¢ÂÖ®Áü•ÂÖ®ËÉΩ</b>.<br>
        O foco √© japon√™s real (N5‚ÜíN4): <b>palavra/kanji ‚Üí pr√°tica ‚Üí corre√ß√£o ‚Üí repeti√ß√£o</b>.<br><br>
        ‚ÄúVampiro‚Äù √© met√°fora do observador que coleta padr√µes do cotidiano.<br>
        ‚ÄúÂÖ®Áü•ÂÖ®ËÉΩ‚Äù representa disciplina: aprender por sistema, sem pular base.
      </p>
    </div>
  </section>

  <div class="footer">„É¥„Ç°„É≥„Éë„Ç§„Ç¢ÂÖ®Áü•ÂÖ®ËÉΩ ¬© 2025 ‚Äî ËæûÂÖ∏ / Kanji / Jogo</div>
</div>

<script>
/* =========================
   DICION√ÅRIO (opcional ‚Äì voc√™ expande)
   ========================= */
const WORDS = [
  {
    jp:"È£ü„Åπ„Çã", hira:"„Åü„Åπ„Çã", tipo:"verbo (ichidan)", mean:"comer", tags:["N5","cotidiano"],
    examples:[
      { jp:"Êúù„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„Åæ„Åó„Åü„ÄÇ", hira:"„ÅÇ„Åï„Åî„ÅØ„Çì „Çí „Åü„Åπ„Åæ„Åó„Åü„ÄÇ", pt:"Comi caf√© da manh√£.", exp:"Êúù„Åî„ÅØ„Çì = caf√© da manh√£; „Çí = objeto; „Äú„Åæ„Åó„Åü = passado polido." },
      { jp:"‰Ωï„ÇíÈ£ü„Åπ„Åü„ÅÑ„Åß„Åô„ÅãÔºü", hira:"„Å™„Å´ „Çí „Åü„Åπ„Åü„ÅÑ „Åß„Åô „ÅãÔºü", pt:"O que voc√™ quer comer?", exp:"„Äú„Åü„ÅÑ = querer; „Åß„Åô„Åã = pergunta educada." },
      { jp:"Âèã„Å†„Å°„Å®Êòº„Åî„ÅØ„Çì„ÇíÈ£ü„Åπ„Å´Ë°å„Åç„Åæ„Åô„ÄÇ", hira:"„Å®„ÇÇ„Å†„Å° „Å® „Å≤„Çã„Åî„ÅØ„Çì „Çí „Åü„Åπ „Å´ „ÅÑ„Åç„Åæ„Åô„ÄÇ", pt:"Vou almo√ßar com um amigo.", exp:"V„Åæ„Åô-stem + „Å´Ë°å„Åè = ir para fazer algo (È£ü„Åπ„Åæ„Åô‚ÜíÈ£ü„Åπ)." }
    ]
  }
];

/* =========================
   KANJI N5 (seus 80) + INFO (leitura/significado)
   ========================= */
const KANJI_ORDER_N5 = [
  "‰∏Ä","‰∏É","‰∏á","‰∏â","‰∏ä","‰∏ã","‰∏≠","‰πù","‰∫å","‰∫î","‰∫∫","‰ªä","‰ºë","‰Ωï","ÂÖà","ÂÖ•","ÂÖ´","ÂÖ≠","ÂÜÜ","Âá∫","ÂàÜ","Ââç","Âåó","ÂçÅ","ÂçÉ","Âçà","Âçä","Âçó","Âèã","Âè≥","Âêç","Âõõ","ÂõΩ","Âúü","Â§ñ","Â§ß","Â§©","Â•≥","Â≠ê","Â≠¶","Â∞è","Â±±","Â∑ù","Â∑¶","Âπ¥","Âæå","Êó•","ÊôÇ","Êõ∏","Êúà","Êú®","Êú¨","Êù•","Êù±","Ê†°","ÊØç","ÊØé","Ê∞ó","Ê∞¥","ÁÅ´","Áà∂","Áîü","Áî∑","ÁôΩ","Áôæ","ËÅû","Ë°å","Ë•ø","Ë¶ã","Ë©±","Ë™û","Ë™≠","Ëªä","Èáë","Èï∑","Èñì","Èõ®","Èõª","È£ü","È´ò"
];

// Leituras aceitas (hiragana/katakana). Significados s√£o ‚Äúpalavras-chave‚Äù PT.
const KANJI_INFO = {
  "‰∏Ä":{lvl:"N5", readings:["„ÅÑ„Å°","„Å≤„Å®"], meanings:["um","1"]},
  "‰∏É":{lvl:"N5", readings:["„Åó„Å°","„Å™„Å™"], meanings:["sete","7"]},
  "‰∏á":{lvl:"N5", readings:["„Åæ„Çì"], meanings:["dez mil","10000","10 mil"]},
  "‰∏â":{lvl:"N5", readings:["„Åï„Çì","„Åø„Å£"], meanings:["tr√™s","3"]},
  "‰∏ä":{lvl:"N5", readings:["„Åò„Çá„ÅÜ","„ÅÜ„Åà","„ÅÇ"], meanings:["cima","acima","superior"]},
  "‰∏ã":{lvl:"N5", readings:["„Åã","„Åó„Åü","„Åï"], meanings:["baixo","abaixo","inferior"]},
  "‰∏≠":{lvl:"N5", readings:["„Å°„ÇÖ„ÅÜ","„Å™„Åã"], meanings:["meio","dentro","centro"]},
  "‰πù":{lvl:"N5", readings:["„Åç„ÇÖ„ÅÜ","„Åì„Åì„ÅÆ"], meanings:["nove","9"]},
  "‰∫å":{lvl:"N5", readings:["„Å´","„Åµ„Åü"], meanings:["dois","2"]},
  "‰∫î":{lvl:"N5", readings:["„Åî","„ÅÑ„Å§"], meanings:["cinco","5"]},
  "‰∫∫":{lvl:"N5", readings:["„Åò„Çì","„Å´„Çì","„Å≤„Å®"], meanings:["pessoa","gente","humano"]},
  "‰ªä":{lvl:"N5", readings:["„Åì„Çì","„ÅÑ„Åæ"], meanings:["agora","atualmente"]},
  "‰ºë":{lvl:"N5", readings:["„Åç„ÇÖ„ÅÜ","„ÇÑ„Åô"], meanings:["descansar","folga","feriado","pausa"]},
  "‰Ωï":{lvl:"N5", readings:["„Å™„Çì","„Å™„Å´"], meanings:["o que","qual"]},
  "ÂÖà":{lvl:"N5", readings:["„Åõ„Çì","„Åï„Åç"], meanings:["antes","anterior","frente","ponta"]},
  "ÂÖ•":{lvl:"N5", readings:["„Å´„ÇÖ„ÅÜ","„ÅÑ"], meanings:["entrar","inserir","entrada"]},
  "ÂÖ´":{lvl:"N5", readings:["„ÅØ„Å°","„ÇÑ"], meanings:["oito","8"]},
  "ÂÖ≠":{lvl:"N5", readings:["„Çç„Åè","„ÇÄ"], meanings:["seis","6"]},
  "ÂÜÜ":{lvl:"N5", readings:["„Åà„Çì"], meanings:["iene","yen","c√≠rculo"]},
  "Âá∫":{lvl:"N5", readings:["„Åó„ÇÖ„Å§","„Åß","„Å†"], meanings:["sair","sa√≠da","aparecer","tirar"]},
  "ÂàÜ":{lvl:"N5", readings:["„Å∂„Çì","„Åµ„Çì","„Çè"], meanings:["minuto","parte","entender"]},
  "Ââç":{lvl:"N5", readings:["„Åú„Çì","„Åæ„Åà"], meanings:["antes","frente","anterior"]},
  "Âåó":{lvl:"N5", readings:["„Åª„Åè","„Åç„Åü"], meanings:["norte"]},
  "ÂçÅ":{lvl:"N5", readings:["„Åò„ÇÖ„ÅÜ","„Å®„Åä"], meanings:["dez","10"]},
  "ÂçÉ":{lvl:"N5", readings:["„Åõ„Çì","„Å°"], meanings:["mil","1000"]},
  "Âçà":{lvl:"N5", readings:["„Åî"], meanings:["meio-dia","am/pm","hora do cavalo"]},
  "Âçä":{lvl:"N5", readings:["„ÅØ„Çì"], meanings:["metade","meia"]},
  "Âçó":{lvl:"N5", readings:["„Å™„Çì","„Åø„Å™„Åø"], meanings:["sul"]},
  "Âèã":{lvl:"N5", readings:["„ÇÜ„ÅÜ","„Å®„ÇÇ"], meanings:["amigo"]},
  "Âè≥":{lvl:"N5", readings:["„ÅÜ","„Åø„Åé"], meanings:["direita"]},
  "Âêç":{lvl:"N5", readings:["„ÇÅ„ÅÑ","„Å™"], meanings:["nome","fama"]},
  "Âõõ":{lvl:"N5", readings:["„Åó","„Çà„Çì","„Çà"], meanings:["quatro","4"]},
  "ÂõΩ":{lvl:"N5", readings:["„Åì„Åè","„Åè„Å´"], meanings:["pa√≠s","na√ß√£o"]},
  "Âúü":{lvl:"N5", readings:["„Å©","„Å§„Å°"], meanings:["terra","solo","s√°bado"]},
  "Â§ñ":{lvl:"N5", readings:["„Åå„ÅÑ","„Åù„Å®","„ÅØ„Åö"], meanings:["fora","exterior"]},
  "Â§ß":{lvl:"N5", readings:["„Å†„ÅÑ","„Åä„Åä"], meanings:["grande"]},
  "Â§©":{lvl:"N5", readings:["„Å¶„Çì","„ÅÇ„Åæ"], meanings:["c√©u","para√≠so"]},
  "Â•≥":{lvl:"N5", readings:["„Åò„Çá","„Åä„Çì„Å™"], meanings:["mulher","feminino"]},
  "Â≠ê":{lvl:"N5", readings:["„Åó","„Åì"], meanings:["crian√ßa","filho"]},
  "Â≠¶":{lvl:"N5", readings:["„Åå„Åè","„Åæ„Å™"], meanings:["estudo","aprender","escola"]},
  "Â∞è":{lvl:"N5", readings:["„Åó„Çá„ÅÜ","„Å°„ÅÑ"], meanings:["pequeno"]},
  "Â±±":{lvl:"N5", readings:["„Åï„Çì","„ÇÑ„Åæ"], meanings:["montanha"]},
  "Â∑ù":{lvl:"N5", readings:["„Åõ„Çì","„Åã„Çè"], meanings:["rio"]},
  "Â∑¶":{lvl:"N5", readings:["„Åï","„Å≤„Å†„Çä"], meanings:["esquerda"]},
  "Âπ¥":{lvl:"N5", readings:["„Å≠„Çì","„Å®„Åó"], meanings:["ano"]},
  "Âæå":{lvl:"N5", readings:["„Åî","„ÅÆ„Å°","„ÅÜ„Åó"], meanings:["depois","atr√°s"]},
  "Êó•":{lvl:"N5", readings:["„Å´„Å°","„Åò„Å§","„Å≤"], meanings:["dia","sol"]},
  "ÊôÇ":{lvl:"N5", readings:["„Åò","„Å®„Åç"], meanings:["hora","tempo"]},
  "Êõ∏":{lvl:"N5", readings:["„Åó„Çá","„Åã"], meanings:["escrever","livro"]},
  "Êúà":{lvl:"N5", readings:["„Åí„Å§","„Åå„Å§","„Å§„Åç"], meanings:["m√™s","lua"]},
  "Êú®":{lvl:"N5", readings:["„ÇÇ„Åè","„Åº„Åè","„Åç"], meanings:["√°rvore","madeira"]},
  "Êú¨":{lvl:"N5", readings:["„Åª„Çì","„ÇÇ„Å®"], meanings:["livro","origem"]},
  "Êù•":{lvl:"N5", readings:["„Çâ„ÅÑ","„Åè","„Åì"], meanings:["vir","pr√≥ximo"]},
  "Êù±":{lvl:"N5", readings:["„Å®„ÅÜ","„Å≤„Åå„Åó"], meanings:["leste"]},
  "Ê†°":{lvl:"N5", readings:["„Åì„ÅÜ"], meanings:["escola"]},
  "ÊØç":{lvl:"N5", readings:["„Åº","„ÅØ„ÅØ"], meanings:["m√£e"]},
  "ÊØé":{lvl:"N5", readings:["„Åæ„ÅÑ"], meanings:["todo","cada"]},
  "Ê∞ó":{lvl:"N5", readings:["„Åç","„Åë"], meanings:["energia","ar","esp√≠rito","clima","humor"]},
  "Ê∞¥":{lvl:"N5", readings:["„Åô„ÅÑ","„Åø„Åö"], meanings:["√°gua","quarta"]},
  "ÁÅ´":{lvl:"N5", readings:["„Åã","„Å≤"], meanings:["fogo","ter√ßa"]},
  "Áà∂":{lvl:"N5", readings:["„Åµ","„Å°„Å°"], meanings:["pai"]},
  "Áîü":{lvl:"N5", readings:["„Åõ„ÅÑ","„Åó„Çá„ÅÜ","„ÅÑ","„ÅÜ","„Å™„Åæ"], meanings:["vida","nascer","cru","aluno"]},
  "Áî∑":{lvl:"N5", readings:["„Å†„Çì","„Åä„Å®„Åì"], meanings:["homem","masculino"]},
  "ÁôΩ":{lvl:"N5", readings:["„ÅØ„Åè","„Åó„Çç"], meanings:["branco"]},
  "Áôæ":{lvl:"N5", readings:["„Å≤„ÇÉ„Åè"], meanings:["cem","100"]},
  "ËÅû":{lvl:"N5", readings:["„Å∂„Çì","„Åç"], meanings:["ouvir","perguntar"]},
  "Ë°å":{lvl:"N5", readings:["„Åì„ÅÜ","„Åé„Çá„ÅÜ","„ÅÑ","„ÇÜ"], meanings:["ir","linha","fazer"]},
  "Ë•ø":{lvl:"N5", readings:["„Åõ„ÅÑ","„Å´„Åó"], meanings:["oeste"]},
  "Ë¶ã":{lvl:"N5", readings:["„Åë„Çì","„Åø"], meanings:["ver","olhar","assistir"]},
  "Ë©±":{lvl:"N5", readings:["„Çè","„ÅØ„Å™"], meanings:["falar","conversa","hist√≥ria"]},
  "Ë™û":{lvl:"N5", readings:["„Åî","„Åã„Åü"], meanings:["l√≠ngua","idioma","palavra"]},
  "Ë™≠":{lvl:"N5", readings:["„Å©„Åè","„Çà"], meanings:["ler"]},
  "Ëªä":{lvl:"N5", readings:["„Åó„ÇÉ","„Åè„Çã„Åæ"], meanings:["carro","ve√≠culo"]},
  "Èáë":{lvl:"N5", readings:["„Åç„Çì","„Åã„Å≠"], meanings:["dinheiro","ouro","sexta"]},
  "Èï∑":{lvl:"N5", readings:["„Å°„Çá„ÅÜ","„Å™„Åå"], meanings:["longo","chefe"]},
  "Èñì":{lvl:"N5", readings:["„Åã„Çì","„Åë„Çì","„ÅÇ„ÅÑ„Å†","„Åæ"], meanings:["entre","intervalo","tempo"]},
  "Èõ®":{lvl:"N5", readings:["„ÅÜ","„ÅÇ„ÇÅ"], meanings:["chuva"]},
  "Èõª":{lvl:"N5", readings:["„Åß„Çì"], meanings:["eletricidade"]},
  "È£ü":{lvl:"N5", readings:["„Åó„Çá„Åè","„Åü"], meanings:["comer","comida"]},
  "È´ò":{lvl:"N5", readings:["„Åì„ÅÜ","„Åü„Åã"], meanings:["alto","caro"]},
};

/* =========================
   CANVAS: tabs
   ========================= */
const sections = {
  dic: document.getElementById("dic"),
  kanji: document.getElementById("kanji"),
  quiz: document.getElementById("quiz"),
  about: document.getElementById("about"),
};

const tabs = {
  dic: document.getElementById("tab-dic"),
  kanji: document.getElementById("tab-kanji"),
  quiz: document.getElementById("tab-quiz"),
  about: document.getElementById("tab-about"),
};

function openTab(id){
  Object.values(sections).forEach(s=>s.classList.remove("active"));
  Object.values(tabs).forEach(t=>t.classList.remove("active"));
  sections[id].classList.add("active");
  tabs[id].classList.add("active");

  if(id==="kanji") renderKanjiGrid();
  if(id==="dic") setTimeout(()=>document.getElementById("q").focus(),0);
}

/* =========================
   UTIL: normalize / html escape / kana
   ========================= */
function escapeHtml(str){
  return (str ?? "").toString()
    .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
    .replaceAll('"',"&quot;").replaceAll("'","&#039;");
}
function normalize(s){
  return (s ?? "")
    .toString().trim().toLowerCase()
    .replace(/[\s„ÄÄ]+/g, "")
    .replace(/[„ÄÇ„ÄÅÔºå,.!?ÔºÅÔºü„Äå„Äç„Äé„ÄèÔºàÔºâ()„Äê„Äë\[\]""'‚Äô]/g, "");
}
function kataToHira(str){
  // converte katakana b√°sico para hiragana (para comparar leitura)
  return (str ?? "").replace(/[\u30A1-\u30F6]/g, ch => String.fromCharCode(ch.charCodeAt(0) - 0x60));
}

/* =========================
   DICION√ÅRIO: busca ranqueada
   ========================= */
const q = document.getElementById("q");
const results = document.getElementById("results");
const onlyExactEl = document.getElementById("onlyExact");

function isExactHeadword(word, qNorm){
  const jp = normalize(word.jp);
  const hira = normalize(word.hira);
  const mean = normalize(word.mean);
  return (jp && jp === qNorm) || (hira && hira === qNorm) || (mean && mean === qNorm);
}
function scoreWord(word, qNorm){
  const jp = normalize(word.jp);
  const hira = normalize(word.hira);
  const mean = normalize(word.mean);

  if(jp === qNorm) return 1000;
  if(hira === qNorm) return 950;
  if(mean === qNorm) return 900;

  if(jp.startsWith(qNorm)) return 780;
  if(hira.startsWith(qNorm)) return 740;
  if(mean.startsWith(qNorm)) return 700;

  if(jp.includes(qNorm)) return 520;
  if(hira.includes(qNorm)) return 500;
  if(mean.includes(qNorm)) return 480;

  const ex = (word.examples || []);
  let best = 0;
  for(const e of ex){
    const ejp = normalize(e.jp);
    const ehira = normalize(e.hira);
    const ept = normalize(e.pt);
    const eexp = normalize(e.exp);
    if(ejp === qNorm || ehira === qNorm || ept === qNorm) best = Math.max(best, 360);
    else if(ejp.includes(qNorm) || ehira.includes(qNorm) || ept.includes(qNorm) || eexp.includes(qNorm)) best = Math.max(best, 220);
  }
  const tags = (word.tags || []).map(normalize);
  const tipo = normalize(word.tipo);
  if(tags.some(t => t.includes(qNorm))) best = Math.max(best, 180);
  if(tipo.includes(qNorm)) best = Math.max(best, 160);

  return best;
}
function renderExamples(examples){
  if(!examples || !examples.length){
    return `<div class="ex"><h4>Exemplos</h4><div class="exp">Sem exemplos ainda.</div></div>`;
  }
  return examples.slice(0,3).map((e, idx)=>`
    <div class="ex">
      <h4>Exemplo ${idx+1}</h4>
      <div class="exline">
        <b>${escapeHtml(e.jp || "")}</b><br>
        <span class="k">${escapeHtml(e.hira || "")}</span><br>
        ${escapeHtml(e.pt || "")}
      </div>
      <div class="exp"><b>Explica√ß√£o (PT-BR):</b> ${escapeHtml(e.exp || "")}</div>
    </div>
  `).join("");
}
function renderResults(raw){
  const query = (raw ?? q.value).trim();
  results.innerHTML = "";

  if(!query){
    results.innerHTML = `<div class="card"><div class="mean" style="color:var(--muted)">Digite algo para buscar.</div></div>`;
    return;
  }

  const qNorm = normalize(query);
  const ranked = WORDS
    .map(w => ({ w, s: scoreWord(w, qNorm) }))
    .filter(x => x.s > 0)
    .sort((a,b)=> b.s - a.s);

  if(!ranked.length){
    results.innerHTML = `<div class="card"><div class="mean">Nenhum resultado para ‚Äú${escapeHtml(query)}‚Äù.</div></div>`;
    return;
  }

  const exact = ranked.filter(x => isExactHeadword(x.w, qNorm));
  const nonExact = ranked.filter(x => !isExactHeadword(x.w, qNorm));
  const onlyExact = !!onlyExactEl.checked;
  const finalList = exact.length ? (onlyExact ? exact : [...exact, ...nonExact]) : ranked;

  const header = document.createElement("div");
  header.className = "card";
  header.innerHTML = `
    <div class="mean">Busca: <b>${escapeHtml(query)}</b> ‚Äî resultados: <b>${finalList.length}</b>
      ${exact.length ? `&nbsp;&nbsp;<span class="badge exact">exato encontrado</span>` : ``}
    </div>
    <div class="hira">Dica: marque ‚Äús√≥ exato (quando houver)‚Äù para foco.</div>
  `;
  results.appendChild(header);

  const LIMIT = 20;
  finalList.slice(0, LIMIT).forEach(item=>{
    const w = item.w;
    const isExact = isExactHeadword(w, qNorm);
    const card = document.createElement("div");
    card.className = "card" + (isExact ? " exact" : "");
    const badges = (w.tags||[]).map(t=>{
      const low = (t||"").toString().toLowerCase();
      if(low==="n5") return `<span class="badge n5">N5</span>`;
      if(low==="n4") return `<span class="badge n4">N4</span>`;
      return `<span class="badge tag">${escapeHtml(t)}</span>`;
    }).join("");

    card.innerHTML = `
      <div class="jp">${escapeHtml(w.jp)}</div>
      <div class="hira">${escapeHtml(w.hira || "‚Äî")}</div>
      <div class="mean">(${escapeHtml(w.tipo || "‚Äî")}) ‚Äî ${escapeHtml(w.mean || "‚Äî")}</div>
      <div class="badges">
        ${isExact ? `<span class="badge exact">resultado exato</span>` : ``}
        ${badges}
      </div>
      ${renderExamples(w.examples || [])}
    `;
    results.appendChild(card);
  });
}

let debounceTimer=null;
q.addEventListener("input", ()=>{
  clearTimeout(debounceTimer);
  debounceTimer=setTimeout(()=>renderResults(q.value),80);
});
onlyExactEl.addEventListener("change", ()=> renderResults(q.value));

document.getElementById("btnClear").addEventListener("click", ()=>{
  q.value=""; renderResults(""); q.focus();
});
document.getElementById("btnRandom").addEventListener("click", ()=>{
  if(!WORDS.length) return;
  const pick = WORDS[Math.floor(Math.random()*WORDS.length)];
  q.value = pick.jp; renderResults(pick.jp);
});
document.getElementById("btnGoKanji").addEventListener("click", ()=> openTab("kanji"));
document.getElementById("btnGoQuiz").addEventListener("click", ()=> openTab("quiz"));

/* =========================
   Stroke order (KanjiVG SVG)
   ========================= */
function codepointHex5(ch){
  const hex = ch.codePointAt(0).toString(16);
  return hex.padStart(5,"0");
}
async function loadKanjiStrokeSVG(kanji, targetEl){
  // KanjiVG via jsDelivr (SVG)
  const hex = codepointHex5(kanji);
  const url = `https://cdn.jsdelivr.net/gh/KanjiVG/kanjivg@master/kanji/${hex}.svg`;

  targetEl.innerHTML = `<div class="small">Carregando stroke order...</div>`;
  try{
    const res = await fetch(url, {cache:"force-cache"});
    if(!res.ok) throw new Error("HTTP "+res.status);
    const svgText = await res.text();

    // limpa atributos que podem quebrar layout e for√ßa responsivo
    const cleaned = svgText
      .replace(/width="[^"]*"/g,'')
      .replace(/height="[^"]*"/g,'')
      .replace(/<\?xml[^>]*\?>/g,'');

    targetEl.innerHTML = cleaned;
  }catch(err){
    targetEl.innerHTML = `
      <div class="small">
        N√£o consegui carregar o SVG agora. <br>
        (1) verifique sua conex√£o <br>
        (2) recarregue a p√°gina (Ctrl+F5) <br>
        (3) clique em ‚ÄúRecarregar‚Äù aqui.
      </div>`;
  }
}

/* =========================
   Kanji tab: grid + details
   ========================= */
const kanjigrid = document.getElementById("kanjigrid");
const kdBox = document.getElementById("kanjiDetail");
const kdEmpty = document.getElementById("kanjiDetailEmpty");
const kdKanji = document.getElementById("kdKanji");
const kdReadings = document.getElementById("kdReadings");
const kdMean = document.getElementById("kdMean");
const kdBadges = document.getElementById("kdBadges");
const kdStroke = document.getElementById("kdStroke");
let currentKanjiSelected = null;

function renderKanjiGrid(){
  kanjigrid.innerHTML = "";
  // N5 primeiro (lista completa). Quando voc√™ expandir N4, pode criar outra lista.
  KANJI_ORDER_N5.forEach(k=>{
    const div = document.createElement("div");
    div.className="kanjiitem";
    div.innerHTML = `<div class="k">${escapeHtml(k)}</div><div class="lvl"><b>N5</b> „Éª clique</div>`;
    div.addEventListener("click", ()=> showKanjiDetail(k));
    kanjigrid.appendChild(div);
  });
}

function showKanjiDetail(k){
  currentKanjiSelected = k;
  const info = KANJI_INFO[k];

  kdEmpty.style.display="none";
  kdBox.style.display="block";

  kdKanji.textContent = k;

  if(info){
    kdReadings.textContent = `Leituras: ${info.readings.join(" / ")}`;
    kdMean.textContent = `Significado (PT): ${info.meanings.join(" / ")}`;
    kdBadges.innerHTML = `<span class="badge n5">N5</span><span class="badge tag">kanji</span>`;
  }else{
    kdReadings.textContent = "Leituras: (n√£o cadastrado ainda)";
    kdMean.textContent = "Significado: (n√£o cadastrado ainda)";
    kdBadges.innerHTML = `<span class="badge tag">sem ficha</span>`;
  }

  loadKanjiStrokeSVG(k, kdStroke);
}

document.getElementById("kdReloadStroke").addEventListener("click", ()=>{
  if(currentKanjiSelected) loadKanjiStrokeSVG(currentKanjiSelected, kdStroke);
});
document.getElementById("kdSearchDic").addEventListener("click", ()=>{
  if(!currentKanjiSelected) return;
  openTab("dic");
  q.value = currentKanjiSelected;
  renderResults(currentKanjiSelected);
  window.scrollTo({top:0, behavior:"smooth"});
});
document.getElementById("kdGoQuiz").addEventListener("click", ()=>{
  if(!currentKanjiSelected) return;
  openTab("quiz");
  setQuizKanji(currentKanjiSelected);
});

/* =========================
   QUIZ: logic
   ========================= */
const quizOnlyN5 = document.getElementById("quizOnlyN5");
const quizKanji = document.getElementById("quizKanji");
const quizReading = document.getElementById("quizReading");
const quizMeaning = document.getElementById("quizMeaning");
const quizCheck = document.getElementById("quizCheck");
const quizReveal = document.getElementById("quizReveal");
const quizNext = document.getElementById("quizNext");
const quizReset = document.getElementById("quizReset");
const quizFeedback = document.getElementById("quizFeedback");
const quizFeedbackTitle = document.getElementById("quizFeedbackTitle");
const quizFeedbackDetail = document.getElementById("quizFeedbackDetail");
const quizStroke = document.getElementById("quizStroke");
const quizReloadStroke = document.getElementById("quizReloadStroke");
const quizScore = document.getElementById("quizScore");
const quizMode = document.getElementById("quizMode");

let quizState = {
  current: "‰∏Ä",
  correct: 0,
  wrong: 0,
  streak: 0
};

function getQuizPool(){
  // por enquanto s√≥ N5 (seus 80). Quando voc√™ adicionar N4, d√° pra juntar.
  return quizOnlyN5.checked ? KANJI_ORDER_N5 : KANJI_ORDER_N5;
}

function setQuizKanji(k){
  quizState.current = k;
  quizKanji.textContent = k;
  quizReading.value = "";
  quizMeaning.value = "";
  hideQuizFeedback();
  loadKanjiStrokeSVG(k, quizStroke); // pr√©-carrega pra ficar imediato quando revelar
  updateQuizMode();
}

function randomFrom(arr){
  return arr[Math.floor(Math.random()*arr.length)];
}

function nextQuizKanji(){
  const pool = getQuizPool();
  const k = randomFrom(pool);
  setQuizKanji(k);
}

function updateQuizMode(){
  quizMode.textContent = quizOnlyN5.checked ? "Modo: N5" : "Modo: N5+N4";
}
quizOnlyN5.addEventListener("change", ()=>{
  updateQuizMode();
  nextQuizKanji();
});

function normalizeMeaning(s){
  return normalize(s).replaceAll("√£","a").replaceAll("√°","a").replaceAll("√†","a").replaceAll("√¢","a")
    .replaceAll("√©","e").replaceAll("√™","e")
    .replaceAll("√≠","i")
    .replaceAll("√≥","o").replaceAll("√¥","o").replaceAll("√µ","o")
    .replaceAll("√∫","u").replaceAll("√ß","c");
}

function checkAnswerScore(){
  const k = quizState.current;
  const info = KANJI_INFO[k];
  if(!info){
    return {readingOk:false, meaningOk:false, readingCorrect:[], meaningCorrect:[]};
  }

  const userR = kataToHira(normalize(quizReading.value));
  const userM = normalizeMeaning(quizMeaning.value);

  const acceptedReadings = info.readings.map(r => kataToHira(normalize(r)));
  const acceptedMeanings = info.meanings.map(m => normalizeMeaning(m));

  const readingOk = userR && acceptedReadings.some(r => r === userR || r.startsWith(userR) || userR.startsWith(r));
  const meaningOk = userM && acceptedMeanings.some(m => userM === m || userM.includes(m) || m.includes(userM));

  return {readingOk, meaningOk, readingCorrect: info.readings, meaningCorrect: info.meanings};
}

function showQuizFeedback({readingOk, meaningOk, readingCorrect, meaningCorrect}, scored){
  quizFeedback.style.display="block";

  const k = quizState.current;
  const rTxt = readingCorrect?.length ? readingCorrect.join(" / ") : "‚Äî";
  const mTxt = meaningCorrect?.length ? meaningCorrect.join(" / ") : "‚Äî";

  const okAll = readingOk && meaningOk;

  if(scored){
    if(okAll){
      quizFeedbackTitle.innerHTML = `‚úÖ <b>Acertou!</b>`;
    }else{
      quizFeedbackTitle.innerHTML = `‚ùå <b>Errou.</b>`;
    }
  }else{
    quizFeedbackTitle.innerHTML = `üëÅÔ∏è <b>Revelado</b> (sem pontuar)`;
  }

  quizFeedbackDetail.innerHTML = `
    Kanji: <b>${escapeHtml(k)}</b><br>
    Leitura correta: <b>${escapeHtml(rTxt)}</b> ${readingOk ? "‚úÖ" : "‚ùå"}<br>
    Significado correto: <b>${escapeHtml(mTxt)}</b> ${meaningOk ? "‚úÖ" : "‚ùå"}
  `;
}

function hideQuizFeedback(){
  quizFeedback.style.display="none";
  quizFeedbackTitle.textContent="";
  quizFeedbackDetail.textContent="";
}

function updateScoreUI(){
  quizScore.textContent = `Acertos: ${quizState.correct} ¬∑ Erros: ${quizState.wrong} ¬∑ Streak: ${quizState.streak}`;
}

quizCheck.addEventListener("click", ()=>{
  const res = checkAnswerScore();
  const okAll = res.readingOk && res.meaningOk;

  if(okAll){
    quizState.correct += 1;
    quizState.streak += 1;
  }else{
    quizState.wrong += 1;
    quizState.streak = 0;
  }
  updateScoreUI();

  showQuizFeedback(res, true);
  // garante stroke no feedback
  loadKanjiStrokeSVG(quizState.current, quizStroke);
});

quizReveal.addEventListener("click", ()=>{
  const res = checkAnswerScore();
  showQuizFeedback(res, false);
  loadKanjiStrokeSVG(quizState.current, quizStroke);
});

quizNext.addEventListener("click", ()=> nextQuizKanji());

quizReset.addEventListener("click", ()=>{
  quizState.correct = 0;
  quizState.wrong = 0;
  quizState.streak = 0;
  updateScoreUI();
  nextQuizKanji();
});

quizReloadStroke.addEventListener("click", ()=>{
  loadKanjiStrokeSVG(quizState.current, quizStroke);
});

/* =========================
   Tab events
   ========================= */
tabs.dic.addEventListener("click", ()=> openTab("dic"));
tabs.kanji.addEventListener("click", ()=> openTab("kanji"));
tabs.quiz.addEventListener("click", ()=> openTab("quiz"));
tabs.about.addEventListener("click", ()=> openTab("about"));

/* =========================
   INIT
   ========================= */
renderResults("");
updateScoreUI();
updateQuizMode();
setQuizKanji("‰∏Ä");
</script>

</body>
</html>
